common-gha-configs:
  airwaves-gha: &airwaves-gha
    runners:
      default: "ubuntu-latest" # or a ["tag", "list"]
      by-name:
        kernel: [ "self-hosted", "Linux", 'armbian', "artifact-kernel" ]
      by-name-and-arch:
        rootfs-arm64: [ "self-hosted", "Linux", 'armbian', "rootfs-arm64" ]
        image-arm64: [ "self-hosted", "Linux", 'armbian', "image-arm64" ]
        rootfs-armhf: [ "self-hosted", "Linux", 'armbian', "rootfs-armhf" ]
        image-armhf: [ "self-hosted", "Linux", 'armbian', "image-armhf" ]
        rootfs-riscv64: [ "self-hosted", "Linux", 'armbian', "rootfs-riscv64" ]
        image-riscv64: [ "self-hosted", "Linux", 'armbian', "image-riscv64" ]

lists:

  my-physical-boards: &my-physical-boards
    # Actual Physical boards
    - { BOARD: odroidn2, BRANCH: edge }
    - { BOARD: odroidhc4, BRANCH: edge }
    - { BOARD: odroidn2l, BRANCH: edge }
    - { BOARD: radxa-zero2, BRANCH: edge }
    - { BOARD: radxa-zero, BRANCH: edge }
    - { BOARD: orangepi3b, BRANCH: legacy }
    - { BOARD: orangepi3b, BRANCH: edge }
    - { BOARD: odroidm1, BRANCH: edge }
    # - { BOARD: tinkerboard-2, BRANCH: legacy }
    - { BOARD: rpi4b, BRANCH: edge, RELEASE: jammy } # rpi4b requires Ubuntu's flash-kernel and will be skipped for Debian
    #- { BOARD: rpi4b, BRANCH: edge, RELEASE: jammy } # rpi4b requires Ubuntu's flash-kernel
    - { BOARD: rockpro64, BRANCH: edge }
    - { BOARD: rockpro64, BRANCH: current }
    - { BOARD: pineh64b, BRANCH: current }
    - { BOARD: orangepi3-lts, BRANCH: current }
    - { BOARD: rockpi-4b, BRANCH: edge }
    - { BOARD: rockpi-4c, BRANCH: edge }
    - { BOARD: rock-4se, BRANCH: edge }
    - { BOARD: khadas-vim3l, BRANCH: edge, ENABLE_EXTENSIONS: "image-output-oowow" }
    - { BOARD: khadas-vim3, BRANCH: edge, ENABLE_EXTENSIONS: "image-output-oowow" }
    - { BOARD: khadas-vim4, BRANCH: legacy, ENABLE_EXTENSIONS: "image-output-oowow" }
    - { BOARD: khadas-vim1s, BRANCH: legacy, ENABLE_EXTENSIONS: "image-output-oowow" }

  my-virtual-boards: &my-virtual-boards
    # UTM images, virtual
    - { BOARD: uefi-arm64, BRANCH: edge, ENABLE_EXTENSIONS: image-output-utm }
    - { BOARD: uefi-x86, BRANCH: edge, ENABLE_EXTENSIONS: image-output-utm }
    # Plain UEFI's, for physical machines
    - { BOARD: uefi-arm64, BRANCH: edge }
    - { BOARD: uefi-x86, BRANCH: edge }

  not-mine: &not-mine
    #- { BOARD: orangepizero2, BRANCH: legacy }
    #- { BOARD: odroidxu4, BRANCH: current }
    #- { BOARD: bananapicm4io, BRANCH: edge }
    #- { BOARD: aml-s9xx-box, BRANCH: edge }
    #- { BOARD: helios64, BRANCH: edge }
    #- { BOARD: rock-5b, BRANCH: collabora, RELEASE: bookworm }
    # - { BOARD: orangepi5, BRANCH: edge }
    #- { BOARD: hikey960, BRANCH: edge } # PR https://github.com/armbian/build/pull/5660
    - { BOARD: hinlink-h28k, BRANCH: legacy } # PR https://github.com/armbian/build/pull/5747
    #- { BOARD: tinkerboard, BRANCH: edge }
    # very distant from being mine
    # - { BOARD: star64, BRANCH: edge, RELEASE: sid } # only sid has proper riscv64 support in Debian?
    #- { BOARD: helios64, BRANCH: current }
    - { BOARD: tritium-h3, BRANCH: edge }
    - { BOARD: tritium-h5, BRANCH: edge }
    - { BOARD: rk322x-box, BRANCH: edge }
    - { BOARD: rk322x-box, BRANCH: current }
    #- { BOARD: nanopiduo2, BRANCH: current, RELEASE: bullseye }

  desktop-boards: &desktop-boards # Gotta define RELEASE here
    - { BOARD: thinkpad-x13s, BRANCH: sc8280xp, RELEASE: lunar, DESKTOP_ENVIRONMENT: gnome, ENABLE_EXTENSIONS: "nicod-armbian-gaming" }
    - { BOARD: thinkpad-x13s, BRANCH: sc8280xp, RELEASE: trixie, DESKTOP_ENVIRONMENT: gnome, ENABLE_EXTENSIONS: "nicod-armbian-gaming" }
    #- { BOARD: thinkpad-x13s, BRANCH: jhovoldsc8280xp, RELEASE: lunar, DESKTOP_ENVIRONMENT: gnome, ENABLE_EXTENSIONS: "nicod-armbian-gaming" }
    #- { BOARD: khadas-vim3, BRANCH: edge, RELEASE: bookworm, DESKTOP_ENVIRONMENT: xfce, ENABLE_EXTENSIONS: "nicod-armbian-gaming" }
    #- { BOARD: khadas-vim3l, BRANCH: edge, RELEASE: bookworm, DESKTOP_ENVIRONMENT: xfce, ENABLE_EXTENSIONS: "nicod-armbian-gaming" }
    #- { BOARD: rock-5-cmio, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    - { BOARD: rock-5b, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    - { BOARD: rock-5a, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    - { BOARD: mixtile-blade3, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    - { BOARD: orangepi5, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    - { BOARD: orangepi5-plus, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    #- { BOARD: mekotronics-r58x, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    - { BOARD: mekotronics-r58x-4g, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    - { BOARD: mekotronics-r58x-pro, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "amazingfated-rk3588,nicod-armbian-gaming" }
    #- { BOARD: mekotronics-r58-minipc, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    #- { BOARD: nanopi-r6s, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    - { BOARD: uefi-x86, BRANCH: edge, RELEASE: jammy, ENABLE_EXTENSIONS: vmware-vm, DESKTOP_APPGROUPS_SELECTED: "none" }
    - { BOARD: khadas-edge2, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming,image-output-oowow" }
    # - { BOARD: odroidm1, BRANCH: legacy, RELEASE: jammy, ENABLE_EXTENSIONS: "v4l2loopback-dkms,amazingfated-rk3588,nicod-armbian-gaming" }
    - { BOARD: orangepi3b, BRANCH: legacy, RELEASE: trixie }

  home-assistant-boards: &home-assistant-boards
    - { BOARD: odroidhc4, BRANCH: current }
    #- { BOARD: tinkerboard-2, BRANCH: edge }

  cloud-rescues: &cloud-rescues
    # rescue e2img's, for both ddk and edge, x86 and arm64
    - { BOARD: uefi-arm64, BRANCH: ddk, ENABLE_EXTENSIONS: uefi-rescue }
    - { BOARD: uefi-arm64, BRANCH: edge,  ENABLE_EXTENSIONS: uefi-rescue }
    - { BOARD: uefi-x86, BRANCH: ddk, ENABLE_EXTENSIONS: uefi-rescue }
    - { BOARD: uefi-x86, BRANCH: edge, ENABLE_EXTENSIONS: uefi-rescue }

  cloud-metadata: &cloud-metadata
    # edge, x86 and arm64, with cloud-metadata
    - { BOARD: uefi-x86, BRANCH: edge, ENABLE_EXTENSIONS: cloud-metadata }
    - { BOARD: uefi-arm64, BRANCH: edge, ENABLE_EXTENSIONS: cloud-metadata }

targets:

  some-userspace-rpardini:
    enabled: no
    configs: [ airwaves-os ]
    pipeline:
      build-image: no # don't build images for this
      only-artifacts: [ "armbian-base-files", "rootfs" ] # only these artifacts
      gha: *airwaves-gha
    vars: # common vars, must exist.
      USERSPACE_ONLY: "yes" # this does nothing, but some var must exist. might as well be this.
      CLOUD_IMAGE: "no" # rpardini-specific cloud stuff due to airwaves-os
    items-from-inventory:
      userspace: # creates items from userspace inventory automatically... 'eos' distributions are always skipped.
        #skip-releases: [ "sid" ] # do NOT include these releases
        only-releases: [ "bookworm"  ] # ONLY include these releases
        # skip-desktops: [ "lxde" ] # do NOT include these desktops
        cli: yes # include normal CLI userspace
        minimal: no # include minimal CLI userspace
        cloud: no # include cloud CLI userspace (rpardini's stuff, default is no)
        desktops: no # include desktops, one per desktop_variations below; 'eos' ones are always skipped
        desktop_variations:
          - [ browsers ] # browsers appgroup
        arches: # wanted architectures, and their "example" BOARD and BRANCH.
          arm64: [ { BOARD: "uefi-arm64", BRANCH: "current" } ]
          amd64: [ { BOARD: "uefi-x86", BRANCH: "current" } ]

  all-of-armbian-wip-no-images-only-kernel-and-uboot:
    enabled: no
    configs: [ airwaves-os ]
    pipeline:
      gha: *airwaves-gha
      # build-image: no # don't build images for this target ("no" here is a boolean, not string)
      #only-artifacts: [ "kernel", "uboot" ] # only build these artifacts for these targets. it's "uboot", not "u-boot"
    vars:
      BUILD_MINIMAL: "yes"
      BUILD_DESKTOP: "no"
      CLOUD_IMAGE: "no"
      RELEASE: jammy

    items-from-inventory:
      #wip: yes # includes all work-in-progress boards
      #all: yes # includes all available BOARD and BRANCH combinations
      #conf: yes # includes all supported boards
      not-eos: yes # not-eos boards, all branches


  cli-debian:
    enabled: yes
    configs: [ airwaves-os ]
    pipeline:
      gha: *airwaves-gha
    vars:
      RELEASE: bookworm
      BUILD_MINIMAL: "no" # quoting "no" is the first lesson of YAML
      CLOUD_IMAGE: "no"
    items: # list of reference-lists
      - *my-physical-boards

  cloud-rescues:
    enabled: no
    configs: [ airwaves-os ]
    pipeline:
      gha: *airwaves-gha
    vars:
      BUILD_MINIMAL: "no"
      CLOUD_IMAGE: "yes"
    expand:
      ubuntu-stable:
        RELEASE: jammy
      debian-stable:
        RELEASE: bookworm
    items: *cloud-rescues

  cloud-metadatas:
    enabled: no
    configs: [ airwaves-os ]
    pipeline:
      gha: *airwaves-gha
    vars:
      BUILD_MINIMAL: "no"
      CLOUD_IMAGE: "yes"
      BUILD_DESKTOP: "no"
    expand:
      ubuntu-stable:
        RELEASE: jammy
      debian-stable:
        RELEASE: bookworm
      debian-testing:
        RELEASE: trixie
    items: *cloud-metadata

  cloud-sbcs:
    enabled: no
    pipeline:
      gha: *airwaves-gha
      build-image: no # I just want packages for these, thanks. no images.
    configs: [ airwaves-os ]
    vars:
      BUILD_MINIMAL: "no"
      CLOUD_IMAGE: "yes"
      BUILD_DESKTOP: "no"
      RELEASE: bookworm
    items: *my-physical-boards

  home-assistant:
    enabled: no
    configs: [ airwaves-os ]
    pipeline:
      gha: *airwaves-gha
    vars:
      BUILD_MINIMAL: "no"
      CLOUD_IMAGE: "no"
      BUILD_DESKTOP: "no"
      RELEASE: bullseye # required for HA stuff.
      ENABLE_EXTENSIONS: "ha"
    items: *home-assistant-boards

  desktop:
    enabled: no
    configs: [ airwaves-os ]
    pipeline:
      gha: *airwaves-gha
    vars:
      BUILD_MINIMAL: "no"
      CLOUD_IMAGE: "no"
      DESKTOP_ENVIRONMENT: "gnome"
      BUILD_DESKTOP: "yes"
      DESKTOP_ENVIRONMENT_CONFIG_NAME: "config_base"
      DESKTOP_APPGROUPS_SELECTED: "browsers" # space or comma separated
    items: *desktop-boards


